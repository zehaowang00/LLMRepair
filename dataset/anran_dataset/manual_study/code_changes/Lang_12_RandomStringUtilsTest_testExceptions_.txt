commit c9d786a4fe2639581047d878a64bab6fb24f1ab3
Author: Sebastian Bazley <sebb@apache.org>
Date:   Sat Jun 9 10:58:34 2012

    LANG-805 RandomStringUtils.random(count, 0, 0, false, false, universe, random) always throws java.lang.ArrayIndexOutOfBoundsException
    
    git-svn-id: https://svn.apache.org/repos/asf/commons/proper/lang/trunk@1348422 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/java/org/apache/commons/lang3/RandomStringUtilsTest.java b/src/test/java/org/apache/commons/lang3/RandomStringUtilsTest.java
--- a/src/test/java/org/apache/commons/lang3/RandomStringUtilsTest.java
+++ b/src/test/java/org/apache/commons/lang3/RandomStringUtilsTest.java
@@ -128,35 +133,44 @@
     public void testExceptions() {
+        final char[] DUMMY = new char[]{'a'}; // valid char array
         try {
             RandomStringUtils.random(-1);
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
             RandomStringUtils.random(-1, true, true);
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
-            RandomStringUtils.random(-1, new char[0]);
+            RandomStringUtils.random(-1, DUMMY);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(1, new char[0]); // must not provide empty array => IAE
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
             RandomStringUtils.random(-1, "");
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
+            RandomStringUtils.random(-1, (String)null);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
             RandomStringUtils.random(-1, 'a', 'z', false, false);
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
-            RandomStringUtils.random(-1, 'a', 'z', false, false, new char[0]);
+            RandomStringUtils.random(-1, 'a', 'z', false, false, DUMMY);
             fail();
         } catch (IllegalArgumentException ex) {}
         try {
-            RandomStringUtils.random(-1, 'a', 'z', false, false, new char[0], new Random());
+            RandomStringUtils.random(-1, 'a', 'z', false, false, DUMMY, new Random());
             fail();
         } catch (IllegalArgumentException ex) {}
     }
     
     /**
      * Make sure boundary alphanumeric characters are generated by randomAlphaNumeric
      * This test will fail randomly with probability = 6 * (61/62)**1000 ~ 5.2E-7
      */  

commit 9b82eaecb12629bfb7861113f69d56e8de1d75a1
Author: Stephen Colebourne <scolebourne@apache.org>
Date:   Thu Jul 31 19:24:35 2003

    Fix RandomStringUtils to not throw NPE all the time
    
    
    git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@137543 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
--- a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
@@ -177,13 +190,35 @@
-        Exception e = null;
+    public void testExceptions() {
         try {
-            r1 = RandomStringUtils.random(-1);
-        } catch (Exception e2) {
-            e = e2;
-        }
-        assertNotNull("random(<0) throws exception", e);
+            RandomStringUtils.random(-1);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, true, true);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, new char[0]);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, "");
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, 'a', 'z', false, false);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, 'a', 'z', false, false, new char[0]);
+            fail();
+        } catch (IllegalArgumentException ex) {}
+        try {
+            RandomStringUtils.random(-1, 'a', 'z', false, false, new char[0], new Random());
+            fail();
+        } catch (IllegalArgumentException ex) {}
     }
     
     /**
      * Make sure boundary alphanumeric characters are generated by randomAlphaNumeric
      * This test will fail randomly with probability = 6 * (61/62)**1000 ~ 5.2E-7
      */  

commit 11d347cce06a5c02b22a17b1281be6008f7173da
Author: Stephen Colebourne <scolebourne@apache.org>
Date:   Mon Jun 9 17:36:03 2003

    Ensure that RandomStringUtils returns all expected characters
    bug 20592, reported/patched by Phil Steitz
    
    
    git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@137365 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
--- a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
@@ -161,9 +163,13 @@
         Exception e = null;
         try {
             r1 = RandomStringUtils.random(-1);
         } catch (Exception e2) {
             e = e2;
         }
         assertNotNull("random(<0) throws exception", e);
     }
     
+    /**
+     * Make sure boundary alphanumeric characters are generated by randomAlphaNumeric
+     * This test will fail randomly with probability = 6 * (61/62)**1000 ~ 5.2E-7
+     */  

commit c55b1bad98a1d2f558dafdf80154c6771bf89e48
Author: Henri Yandell <bayard@apache.org>
Date:   Tue May 13 22:50:43 2003

    Bug #19880 fixed. RandomStringUtils.random(int count, char[] set)
    doesn't include the last character in set.
    
    Submitted by:   Phil Steitz
    
    
    git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@137313 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
--- a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
@@ -161,8 +161,9 @@
         Exception e = null;
         try {
             r1 = RandomStringUtils.random(-1);
         } catch (Exception e2) {
             e = e2;
         }
         assertNotNull("random(<0) throws exception", e);
     }
+    

commit 11a540bcf9dcf08b238917e4fd0fb843c34f1f56
Author: Henri Yandell <bayard@apache.org>
Date:   Wed Apr 9 10:13:03 2003

    Patch for RandomString bug in which counts of 0 or negative counts would cause array exceptions.
    
    Submitted by:   ville.skytta@iki.fi (Ville Skyttï¿½)
    
    
    git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@137289 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
--- a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
@@ -157,1 +161,8 @@
+        Exception e = null;
+        try {
+            r1 = RandomStringUtils.random(-1);
+        } catch (Exception e2) {
+            e = e2;
+        }
+        assertNotNull("random(<0) throws exception", e);
     }

commit d23b22c78078ee7468e797e80188ae9508c0eee0
Author: Henri Yandell <bayard@apache.org>
Date:   Thu Jul 18 23:35:56 2002

    Initial copy from jakarta-commons-sandbox
    
    
    git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@136932 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/src/test/org/apache/commons/lang/RandomStringUtilsTest.java b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
--- /dev/null
+++ b/src/test/org/apache/commons/lang/RandomStringUtilsTest.java
@@ -0,0 +151,1 @@
+    }
